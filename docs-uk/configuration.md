# Конфігурація та Файли Системи

Цей документ описує всі конфігураційні файли, папки та структуру даних, які створюються та використовуються системою WebQuiz під час роботи.

## Структура папок

Під час запуску WebQuiz автоматично створює наступну структуру папок:

```
webquiz/
├── quizzes/              # Папка з тестами у YAML форматі
├── logs/                 # Логи серверу
├── csv_data/             # CSV файли з відповідями користувачів
├── static/               # Статичні файли веб-інтерфейсу
└── webquiz.yaml          # Головний конфігураційний файл
```

## Конфігураційний файл webquiz.yaml

Головний конфігураційний файл системи створюється автоматично при першому запуску:

```yaml
# Налаштування сервера
server:
  host: "0.0.0.0"          # IP адреса для підключення
  port: 8080               # Порт сервера

# Шляхи до папок
paths:
  quizzes_dir: "./quizzes"      # Папка з тестами
  logs_dir: "./logs"            # Папка з логами
  csv_dir: "./csv_data"         # Папка з CSV файлами
  static_dir: "./static"        # Папка зі статичними файлами

# Налаштування безпеки
security:
  master_key: ""               # Ключ доступу до адмін-панелі

# Додаткові налаштування тестів
options:
  csv_flush_interval: 30       # Інтервал збереження CSV (секунди)
  log_level: "INFO"            # Рівень логування
```

## Папка з тестами (quizzes/)

Містить YAML файли з питаннями та відповідями:

### Формат файлу тесту

```yaml
# default.yaml - приклад тесту
title: "Тестовий Quiz"
show_right_answer: true

questions:
  - question: "Скільки буде 2 + 2?"
    options:
      - "3"
      - "4"
      - "5"
      - "6"
    correct_answer: 1          # Індекс правильної відповіді (починаючи з 0)

  - question: "Яка столиця України?"
    image: "ukraine_map.jpg"   # Опціональне зображення
    options:
      - "Харків"
      - "Львів" 
      - "Київ"
      - "Одеса"
    correct_answer: 2
    
  - question: "Питання з декількома правильними відповідями"
    options:
      - "Варіант 1"
      - "Варіант 2"
      - "Варіант 3"
      - "Варіант 4"
    correct_answer: [0, 2]     # Множинні правильні відповіді
    min_correct_answers: 1     # Мінімальна кількість правильних відповідей
```

### Обов'язкові поля:
- `question` - текст питання
- `options` - список варіантів відповідей (мінімум 2)
- `correct_answer` - індекс правильної відповіді або список індексів

### Опціональні поля:
- `title` - назва тесту
- `show_right_answer` - показувати правильну відповідь після помилки
- `image` - шлях до зображення для питання
- `min_correct_answers` - для питань з множинними відповідями

## Логи системи (logs/)

Сервер створює файли логів з унікальними суфіксами:

```
logs/
├── server_0001.log       # Перший запуск
├── server_0002.log       # Другий запуск
└── server_0003.log       # Третій запуск
```

### Формат записів у лозі:
```
2024-01-15 10:30:25,123 - webquiz.server - INFO - Server started on 0.0.0.0:8080
2024-01-15 10:30:30,456 - webquiz.server - INFO - User registered: john_doe
2024-01-15 10:30:45,789 - webquiz.server - INFO - Answer submitted for question 1
```

## CSV файли з відповідями (csv_data/)

Відповіді користувачів зберігаються у CSV файлах з префіксом назви тесту:

```
csv_data/
├── default_user_responses_0001.csv
├── math_quiz_user_responses_0001.csv
└── geography_quiz_user_responses_0001.csv
```

### Структура CSV файлу:
```csv
user_id,username,question_text,selected_answer_text,correct_answer_text,is_correct,time_taken_seconds
abc-123,john_doe,"Скільки буде 2 + 2?","4","4",true,3.45
abc-123,john_doe,"Яка столиця України?","Львів","Київ",false,7.22
```

### Поля CSV файлу:
- `user_id` - унікальний ідентифікатор користувача
- `username` - ім'я користувача  
- `question_text` - текст питання
- `selected_answer_text` - обрана відповідь
- `correct_answer_text` - правильна відповідь
- `is_correct` - чи правильна відповідь
- `time_taken_seconds` - час відповіді в секундах

## Статичні файли (static/)

Папка містить згенеровані веб-файли:

```
static/
├── index.html                    # Головна сторінка тесту
├── questions_for_client.json     # JSON з питаннями (без правильних відповідей)
└── assets/                       # Додаткові ресурси
    ├── images/                   # Зображення до питань
    └── styles/                   # CSS стилі
```

### Автогенерація файлів

Система автоматично генерує наступні файли:

1. **index.html** - вбудовує дані тесту прямо у HTML
2. **questions_for_client.json** - безпечна версія питань без правильних відповідей
3. **webquiz.yaml** - якщо відсутній, створюється з базовими налаштуваннями

## Безпека та захист даних

### Захищені дані:
- Правильні відповіді не передаються клієнту
- Ключ адміністратора зберігається у конфігурації
- Валідація відповідей відбувається на сервері

### Автоматичне резервування:
- CSV файли оновлюються кожні 30 секунд
- Логи зберігаються з унікальними іменами
- Попередні версії файлів не перезаписуються

## Змінні середовища

Можна використовувати змінні середовища для налаштування:

```bash
export WEBQUIZ_MASTER_KEY="your_secret_key"
export WEBQUIZ_PORT=9090
export WEBQUIZ_HOST="127.0.0.1"
```

## Приклади використання

### Додавання нового тесту:
1. Створіть файл `new_quiz.yaml` у папці `quizzes/`
2. Додайте питання згідно з форматом
3. Перезапустіть сервер або використайте адмін-панель

### Зміна конфігурації:
1. Відредагуйте `webquiz.yaml`
2. Перезапустіть сервер командою `webquiz`

### Аналіз результатів:
1. Відкрийте CSV файли з папки `csv_data/`
2. Використайте Excel, LibreOffice або pandas для аналізу