# Формат файлу тесту (quiz.yaml)

Тести у **WebQuiz** зберігаються у форматі YAML.
Кожен файл містить заголовок, опис (за бажанням) і список питань.
Ви можете створювати свої власні тести, розміщуючи їх у папці **`quizzes/`**.

---

## Структура файлу

Базова структура файлу тесту виглядає так:

```
title: "Назва тесту"
description: "Опис тесту (необов'язково)"
show_right_answer: false
questions:
  - question: "Текст питання"
    options: ["Варіант 1", "Варіант 2", "Варіант 3"]
    correct_answer: 0
```

---

## 1. Основні параметри тесту

### `title` (обов'язковий)

Назва тесту, яка відображається у веб-інтерфейсі та в адміністративній панелі.

```
title: "Тест з математики"
```

---

### `description` (необов'язковий)

Короткий опис тесту. Може містити інформацію про тему, складність або інші деталі.

```
description: "Базові арифметичні операції для учнів 5-го класу"
```

---

### `show_right_answer` (необов'язковий)

Визначає, чи показувати користувачу правильну відповідь після надсилання його варіанта.

- `true` — після відповіді користувач бачить, яка відповідь була правильною
- `false` (за замовчуванням) — користувач бачить лише позначку правильно/неправильно (зелений/червоний колір)

```
show_right_answer: true
```

---

## 2. Розділ `questions`

Розділ `questions` містить список питань тесту.
Кожне питання — це окремий елемент списку з власними параметрами.

---

### Базове питання з одиничним вибором

Найпростіша форма питання з текстом, варіантами відповідей та індексом правильної відповіді:

```
- question: "Скільки буде 2 + 2?"
  options: ["3", "4", "5", "6"]
  correct_answer: 1
```

- **question** — текст питання
- **options** — список можливих відповідей (масив рядків)
- **correct_answer** — індекс правильної відповіді (починається з 0)

У цьому прикладі правильна відповідь — `"4"` (індекс 1).

---

### Питання з кількома правильними відповідями

WebQuiz підтримує питання, у яких правильних відповідей може бути декілька.
У такому випадку користувач повинен вибрати **всі правильні варіанти**.

```
- question: "Які з цих мов є мовами програмування?"
  options: ["Python", "HTML", "JavaScript", "CSS"]
  correct_answer: [0, 2]
```

У цьому прикладі правильні відповіді — `"Python"` (індекс 0) і `"JavaScript"` (індекс 2).

> ⚠️ **Важливо:** За замовчуванням користувач має вибрати **всі правильні відповіді**, щоб отримати позитивний результат.

---

### Питання з мінімальною кількістю правильних відповідей

Якщо ви хочете, щоб питання вважалося правильним при виборі **мінімальної кількості** з усіх правильних відповідей, використовуйте параметр **`min_correct`**:

```
- question: "Виберіть принаймні 2 основних кольори:"
  options: ["Червоний", "Зелений", "Синій", "Жовтий"]
  correct_answer: [0, 2, 3]
  min_correct: 2
```

У цьому прикладі:
- Правильні відповіді: `"Червоний"` (0), `"Синій"` (2), `"Жовтий"` (3)
- Користувач має вибрати **мінімум 2** з них
- Якщо користувач вибере `"Червоний"` і `"Синій"`, відповідь буде зарахована як правильна

---

### Питання із зображенням

Ви можете додати зображення до питання, використовуючи параметр **`image`**.
Зображення мають зберігатися у папці **`quizzes/imgs/`**.

```
- question: "Яка столиця України?"
  image: "/imgs/ukraine_map.png"
  options: ["Київ", "Львів", "Одеса", "Харків"]
  correct_answer: 0
```

Шлях до зображення вказується відносно веб-кореня (`/imgs/`).

---

### Питання лише із зображенням (без тексту)

Якщо питання складається лише із зображення (наприклад, "Що зображено на картинці?"), ви можете **не вказувати поле `question`**:

```
- image: "/imgs/coordinate_system.png"
  options: ["MGRS", "UTM", "УСК-2000", "WGS84"]
  correct_answer: 2
```

У цьому випадку користувач побачить лише зображення та варіанти відповідей.

---

### Питання з графічними варіантами відповідей

Варіанти відповідей також можуть бути зображеннями.
Для цього замість тексту у списку `options` вказуйте шляхи до зображень:

```
- question: "Який символ позначає правильну відповідь?"
  options:
    - "/imgs/checkmark.png"
    - "/imgs/cross.png"
    - "/imgs/question.png"
  correct_answer: 0
```

---

### Комбіноване питання: зображення + текстові варіанти

Ви можете поєднувати зображення у питанні з текстовими варіантами відповідей:

```
- question: "Яка система координат зображена на картинці?"
  image: "/imgs/coordinate_grid.png"
  options: ["Декартова", "Полярна", "Циліндрична", "Сферична"]
  correct_answer: 1
```

---

## 3. Повний приклад файлу тесту

Нижче наведено приклад повного файлу тесту з різними типами питань:

```
title: "Комплексний тест з різними типами питань"
description: "Приклад тесту, що демонструє всі можливості форматування"
show_right_answer: true

questions:
  # Просте питання з одним правильним варіантом
  - question: "Скільки буде 5 × 3?"
    options: ["8", "12", "15", "18"]
    correct_answer: 2

  # Питання з кількома правильними відповідями
  - question: "Які з цих мов є мовами програмування?"
    options: ["Python", "HTML", "JavaScript", "CSS", "Ruby"]
    correct_answer: [0, 2, 4]

  # Питання з мінімальною кількістю правильних відповідей
  - question: "Виберіть принаймні 2 європейські столиці:"
    options: ["Париж", "Нью-Йорк", "Лондон", "Токіо", "Берлін"]
    correct_answer: [0, 2, 4]
    min_correct: 2

  # Питання із зображенням
  - question: "Яка країна зображена на мапі?"
    image: "/imgs/france_map.png"
    options: ["Німеччина", "Франція", "Іспанія", "Італія"]
    correct_answer: 1

  # Питання лише із зображенням (без тексту)
  - image: "/imgs/python_logo.png"
    options: ["Java", "Python", "Ruby", "JavaScript"]
    correct_answer: 1

  # Питання з графічними варіантами відповідей
  - question: "Який прапор належить Україні?"
    options:
      - "/imgs/flag_poland.png"
      - "/imgs/flag_ukraine.png"
      - "/imgs/flag_russia.png"
    correct_answer: 1
```

---

## 4. Правила та рекомендації

### Нумерація індексів

Індекси у `correct_answer` завжди починаються з **0**.

| Індекс | Варіант відповіді |
|--------|-------------------|
| 0      | Перший варіант    |
| 1      | Другий варіант    |
| 2      | Третій варіант    |
| 3      | Четвертий варіант |

---

### Збереження зображень

Усі зображення мають зберігатися у папці **`quizzes/imgs/`**.
Шляхи до зображень у файлі тесту вказуються як `/imgs/назва_файлу.png`.

Підтримувані формати:
- PNG (.png)
- JPEG (.jpg, .jpeg)
- GIF (.gif)
- SVG (.svg)

---

### Кодування файлів

Файли тестів мають бути збережені у кодуванні **UTF-8**, щоб коректно відображався текст українською, російською та іншими мовами з кирилицею.

---

### Перевірка синтаксису

**Рекомендований спосіб:** Використовуйте **веб-інтерфейс адміністратора** для створення та редагування тестів.
Адміністративна панель автоматично перевіряє синтаксис YAML перед збереженням файлу та показує помилки, якщо вони є.

Якщо ви редагуєте файли вручну і після редагування тест не завантажується, перевірте:
- Правильність відступів (YAML вимагає точних відступів)
- Наявність лапок навколо текстових значень із спецсимволами
- Відповідність індексів у `correct_answer` кількості варіантів у `options`

---

## 5. Створення нового тесту

### Через адміністративний інтерфейс (рекомендовано)

1. Відкрийте адміністративну панель за адресою `http://localhost:8080/admin/`
2. Введіть майстер-ключ для доступу
3. Використовуйте вбудований редактор для створення нового тесту
4. Редактор автоматично перевірить синтаксис перед збереженням
5. Якщо у файлі є помилки, ви побачите повідомлення про них

### Вручну через файлову систему

1. Відкрийте папку **`quizzes/`** у вашій робочій директорії WebQuiz.
2. Створіть новий файл із розширенням `.yaml`, наприклад `my_test.yaml`.
3. Заповніть файл згідно зі структурою, описаною вище.
4. Збережіть файл у кодуванні UTF-8.
5. Перезапустіть сервер WebQuiz або перемкніть тест в адміністративній панелі.

Новий тест з'явиться у списку доступних тестів у розділі **Адміністрування**.

---

## 6. Редагування існуючих тестів

### Через адміністративний інтерфейс (рекомендовано)

1. Відкрийте адміністративну панель
2. Виберіть тест для редагування
3. Внесіть зміни у вбудованому редакторі
4. Натисніть "Зберегти" — валідація відбудеться автоматично
5. При наявності помилок вони будуть показані на екрані

### Вручну через файлову систему

1. Відкрийте відповідний `.yaml` файл у папці **`quizzes/`** у текстовому редакторі.
2. Внесіть потрібні зміни.
3. Збережіть файл.
4. У адміністративній панелі перемкніть тест на інший, а потім знову поверніться до відредагованого — зміни застосуються автоматично.

> 💡 **Порада:** Використовуйте **адміністративний веб-інтерфейс** для створення та редагування тестів — він має вбудовану валідацію YAML і попередить вас про помилки перед збереженням.

---

## 7. Поширені помилки

### Неправильні відступи

YAML чутливий до відступів. Усі елементи одного рівня мають мати однакові відступи.

**Неправильно:**
```
questions:
- question: "Текст"
   options: ["A", "B"]
  correct_answer: 0
```

**Правильно:**
```
questions:
  - question: "Текст"
    options: ["A", "B"]
    correct_answer: 0
```

---

### Невідповідність індексів

Якщо у `correct_answer` вказано індекс, якого немає у `options`, тест не завантажиться.

**Неправильно:**
```
options: ["A", "B", "C"]
correct_answer: 3  # Індексу 3 не існує (є лише 0, 1, 2)
```

**Правильно:**
```
options: ["A", "B", "C"]
correct_answer: 2  # Індекс 2 = варіант "C"
```

---

### Відсутність лапок у тексті зі спецсимволами

Якщо текст питання або варіанта містить спецсимволи (`:`, `#`, `{`, `}`), його потрібно взяти у лапки.

**Неправильно:**
```
question: Скільки буде 2:1?
```

**Правильно:**
```
question: "Скільки буде 2:1?"
```

> 💡 **Порада:** Адміністративний інтерфейс автоматично виявить ці помилки та покаже їх перед збереженням файлу.

---

## Додаткові можливості

### Завантаження тестів через адміністративний інтерфейс

Якщо у файлі конфігурації `config.yaml` заповнено розділ **`quizzes`**, адміністратор може завантажувати тести безпосередньо з веб-інтерфейсу.

Приклад розділу у `config.yaml`:

```
quizzes:
  - name: "Тест з географії"
    download_path: "https://example.com/tests/geography.zip"
    folder: "geography/"
```

Після завантаження архів автоматично розпаковується у вказану папку всередині `quizzes/`.

---

### Перемикання між тестами

Адміністратор може перемикати активний тест у будь-який момент через панель **Адміністрування**.
При зміні тесту:
- Усі активні сесії користувачів скидаються
- Результати попереднього тесту зберігаються у відповідних CSV-файлах
- Завантажується новий набір питань

---

## Приклади реальних тестів

### Тест з математики

```
title: "Базова арифметика"
description: "Тест на знання арифметичних операцій"

questions:
  - question: "Скільки буде 7 + 5?"
    options: ["10", "11", "12", "13"]
    correct_answer: 2

  - question: "Скільки буде 9 × 6?"
    options: ["45", "54", "63", "72"]
    correct_answer: 1

  - question: "Скільки буде 20 ÷ 4?"
    options: ["4", "5", "6", "8"]
    correct_answer: 1
```

---

### Тест з географії із зображеннями

```
title: "Країни та прапори"
description: "Розпізнавання прапорів країн світу"

questions:
  - image: "/imgs/flag_france.png"
    options: ["Італія", "Франція", "Бельгія", "Нідерланди"]
    correct_answer: 1

  - image: "/imgs/flag_japan.png"
    options: ["Китай", "Корея", "Японія", "В'єтнам"]
    correct_answer: 2

  - question: "Яка столиця Німеччини?"
    options: ["Мюнхен", "Берлін", "Франкфурт", "Гамбург"]
    correct_answer: 1
```

---

### Тест з програмування з множинним вибором

```
title: "Основи програмування"
show_right_answer: true

questions:
  - question: "Які мови є об'єктно-орієнтованими?"
    options: ["Python", "C", "Java", "Assembly", "C#"]
    correct_answer: [0, 2, 4]

  - question: "Які структури даних є лінійними?"
    options: ["Масив", "Дерево", "Список", "Граф", "Стек"]
    correct_answer: [0, 2, 4]
    min_correct: 2
```

---

## Підсумок

Формат YAML для тестів у **WebQuiz** дозволяє:

✅ Створювати питання з одиничним та множинним вибором
✅ Додавати зображення до питань і варіантів відповідей
✅ Встановлювати мінімальну кількість правильних відповідей
✅ Показувати або приховувати правильні відповіді після проходження
✅ Легко редагувати тести у веб-інтерфейсі з автоматичною валідацією

**Рекомендація:** Використовуйте адміністративний веб-інтерфейс для створення та редагування тестів — він автоматично перевіряє синтаксис і попереджає про помилки!
